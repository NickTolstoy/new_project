# База данных Автосервиса АвтосервисЛюбань

## Структура базы данных

В этом каталоге содержится схема базы данных MySQL для управления данными автосервиса электромобилей. База данных включает следующие основные компоненты:

### Основные таблицы

1. **users** - пользователи системы (клиенты, администраторы, менеджеры, техники)
2. **user_cars** - автомобили, принадлежащие пользователям
3. **service_categories** - категории услуг автосервиса
4. **services** - конкретные услуги в рамках категорий
5. **appointments** - записи клиентов на обслуживание
6. **service_history** - история выполненных работ
7. **reviews** - отзывы клиентов
8. **contact_forms** - заполненные формы обратной связи
9. **blog_posts** - статьи блога
10. **blog_categories** - категории блога

### Вспомогательные таблицы

1. **service_statuses** - статусы работ (новая, подтверждена, в работе и т.д.)
2. **form_types** - типы форм обратной связи
3. **user_tokens** - токены для сессий и сброса паролей
4. **user_notifications** - уведомления пользователей
5. **user_settings** - настройки пользователей

## Инструкция по установке

### Требования

- MySQL 5.7+ или MariaDB 10.3+
- Права доступа для создания базы данных и таблиц

### Установка схемы

1. Подключитесь к серверу MySQL:
   ```
   mysql -u USERNAME -p
   ```

2. Выполните SQL скрипт:
   ```
   mysql -u USERNAME -p < schema.sql
   ```
   или запустите содержимое файла schema.sql через MySQL Workbench или phpMyAdmin

## Интеграция с приложением

### Будущий личный кабинет пользователя

База данных спроектирована с учетом будущего добавления личного кабинета пользователя. Основные функции, которые будут поддерживаться:

- Регистрация и авторизация пользователей
- Управление профилем (изменение данных, аватар)
- Добавление и управление своими автомобилями
- Запись на обслуживание
- История обслуживания
- Оставление отзывов о сервисе
- Получение уведомлений

### Переход от localStorage к базе данных

В текущей версии сайта данные форм и отзывов хранятся в localStorage. Для перехода на базу данных необходимо будет:

1. Создать API для взаимодействия с базой данных
2. Реализовать миграцию данных из localStorage в базу данных
3. Обновить компоненты React, чтобы они работали с API вместо localStorage

## Связи между таблицами

![ER диаграмма](./er-diagram.png)

Основные связи:

- `users` 1:N `user_cars` - у пользователя может быть несколько автомобилей
- `users` 1:N `reviews` - пользователь может оставить несколько отзывов
- `users` 1:N `appointments` - пользователь может создать несколько записей на обслуживание
- `service_categories` 1:N `services` - категория содержит несколько услуг
- `appointments` 1:1 `service_history` - запись может быть связана с историей обслуживания

## Поддержка и расширение

База данных спроектирована с учетом возможного масштабирования. В будущем она может быть расширена для:

- Внедрения системы скидок и бонусов
- Управления запчастями и инвентарем
- Интеграции с системами оплаты
- Расширенной аналитики и отчетности

## Безопасность

Для обеспечения безопасности данных рекомендуется:

1. Хранить пароли только в хешированном виде (поле `password_hash` в таблице `users`)
2. Использовать подготовленные запросы для предотвращения SQL-инъекций
3. Настроить регулярное резервное копирование базы данных
4. Ограничить доступ к базе данных только необходимыми IP-адресами 